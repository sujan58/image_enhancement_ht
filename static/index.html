<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AquaVision â€” Underwater Video Enhancement</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        *,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
        :root{
            --p50:#faf5ff;--p100:#f3e8ff;--p200:#e9d5ff;--p300:#d8b4fe;
            --p400:#c084fc;--p500:#a855f7;--p600:#9333ea;--p700:#7e22ce;
            --p800:#6b21a8;--p900:#581c87;--p950:#3b0764;
            --bg:#0c0a14;--surface:#16121f;--surface2:#1e1a2a;
            --border:#2d2740;--text:#ede9f6;--dim:#a89ec4;--radius:14px;
        }
        body{font-family:'Inter',system-ui,sans-serif;background:var(--bg);color:var(--text);min-height:100vh}

        /* Animated purple glow background */
        .bg-glow{position:fixed;inset:0;z-index:0;pointer-events:none;
            background:radial-gradient(600px 400px at 20% 10%,rgba(147,51,234,.12),transparent),
                        radial-gradient(500px 500px at 80% 80%,rgba(168,85,247,.08),transparent)}

        .container{position:relative;z-index:1;max-width:720px;margin:0 auto;padding:2.5rem 1.5rem 4rem}

        /* Header */
        header{text-align:center;padding:3rem 0 2.5rem}
        .logo{font-size:2.2rem;font-weight:800;letter-spacing:-.02em;
            background:linear-gradient(135deg,var(--p300),var(--p500));
            -webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent}
        header p{color:var(--dim);margin-top:.4rem;font-size:.95rem}

        /* Card */
        .card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);
            padding:2rem;margin-bottom:1.5rem;transition:border-color .3s}
        .card:hover{border-color:var(--p700)}
        .card h2{font-size:1.05rem;font-weight:700;margin-bottom:1rem;display:flex;align-items:center;gap:.5rem}
        .step{display:inline-flex;align-items:center;justify-content:center;width:28px;height:28px;
            border-radius:8px;font-size:.8rem;background:var(--p700);color:#fff;flex-shrink:0}

        /* Dropzone */
        .dropzone{border:2px dashed var(--border);border-radius:var(--radius);padding:3rem 1rem;
            text-align:center;cursor:pointer;transition:all .3s;position:relative}
        .dropzone.drag-over,.dropzone:hover{border-color:var(--p500);background:rgba(147,51,234,.06)}
        .dropzone input{position:absolute;inset:0;opacity:0;cursor:pointer}
        .dropzone .icon{font-size:2.5rem;margin-bottom:.5rem}
        .dropzone p{color:var(--dim);font-size:.9rem}
        .file-info{margin-top:.75rem;font-weight:600;color:var(--p300);display:none}
        .file-info.show{display:block}

        /* Button */
        .btn{display:inline-flex;align-items:center;justify-content:center;gap:.5rem;width:100%;
            padding:.9rem 1.5rem;font-size:1rem;font-weight:600;border:none;border-radius:10px;
            cursor:pointer;font-family:inherit;transition:all .25s;
            background:linear-gradient(135deg,var(--p600),var(--p700));color:#fff}
        .btn:hover{transform:translateY(-2px);box-shadow:0 8px 24px rgba(147,51,234,.35)}
        .btn:active{transform:translateY(0)}
        .btn:disabled{opacity:.45;cursor:not-allowed;transform:none;box-shadow:none}
        .btn-outline{background:transparent;border:1px solid var(--p600);color:var(--p400)}
        .btn-outline:hover{background:rgba(147,51,234,.1);box-shadow:0 4px 16px rgba(147,51,234,.15)}

        /* Progress */
        .progress{display:none}
        .progress.show{display:block}
        .bar-track{width:100%;height:8px;background:var(--surface2);border-radius:99px;overflow:hidden;margin:1rem 0}
        .bar-fill{height:100%;width:0%;border-radius:99px;background:linear-gradient(90deg,var(--p500),var(--p400));transition:width .4s}
        .progress p{text-align:center;font-size:.85rem;color:var(--dim)}

        /* Result */
        .result{display:none}
        .result.show{display:block}
        .video-box{border-radius:var(--radius);overflow:hidden;border:1px solid var(--border);background:#000}
        .video-box video{width:100%;display:block}
        .actions{display:flex;gap:.75rem;margin-top:1rem}
        .actions .btn{flex:1}

        /* Toast */
        .toast{position:fixed;bottom:2rem;left:50%;transform:translateX(-50%);background:#dc2626;
            color:#fff;padding:.75rem 1.5rem;border-radius:10px;font-size:.9rem;font-weight:500;
            z-index:100;display:none;box-shadow:0 8px 32px rgba(0,0,0,.5)}
        .toast.show{display:block;animation:slideUp .3s ease}
        @keyframes slideUp{from{opacity:0;transform:translate(-50%,20px)}to{opacity:1;transform:translate(-50%,0)}}

        footer{text-align:center;padding:2rem 0 1rem;color:var(--dim);font-size:.8rem}
        footer a{color:var(--p400);text-decoration:none}

        @media(max-width:640px){.container{padding:1rem}.card{padding:1.25rem}header{padding:2rem 0 1.5rem}
            .logo{font-size:1.5rem}.actions{flex-direction:column}}
    </style>
</head>
<body>
<div class="bg-glow"></div>
<div class="container">

    <header>
        <div class="logo">ðŸŒŠ AquaVision</div>
        <p>AI-Powered Underwater Video Enhancement</p>
    </header>

    <!-- STEP 1 -->
    <div class="card">
        <h2><span class="step">1</span> Upload Underwater Video</h2>
        <div class="dropzone" id="dropzone">
            <input type="file" id="fileInput" accept="video/*">
            <div class="icon">ðŸŽ¬</div>
            <p>Drag & drop your video here, or <strong style="color:var(--p400)">click to browse</strong></p>
            <p style="font-size:.78rem;margin-top:.3rem">MP4, AVI, MOV, MKV, WEBM</p>
            <div class="file-info" id="fileInfo"></div>
        </div>
    </div>

    <!-- STEP 2 -->
    <div class="card">
        <h2><span class="step">2</span> Enhance Video</h2>
        <button class="btn" id="processBtn" disabled>
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polygon points="5 3 19 12 5 21 5 3"/></svg>
            Process Video
        </button>
        <div class="progress" id="progress">
            <div class="bar-track"><div class="bar-fill" id="barFill"></div></div>
            <p id="progressText">Uploading &amp; enhancing framesâ€¦ this may take a while.</p>
        </div>
    </div>

    <!-- RESULT -->
    <div class="result" id="result">
        <div class="card">
            <h2>âœ¨ Enhanced Video</h2>
            <div class="video-box">
                <video id="resultVideo" controls></video>
            </div>
            <div class="actions">
                <a id="downloadLink" class="btn" download>
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                    Download
                </a>
                <button class="btn btn-outline" onclick="resetUI()">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="1 4 1 10 7 10"/><path d="M3.51 15a9 9 0 105.64-11.36L1 10"/></svg>
                    Process Another
                </button>
            </div>
        </div>
    </div>

</div>

<footer>Built with ðŸ’œ â€” <a href="https://github.com/SyedAejazAhmed/AI-Based-Underwater-Image-Enhancement-System-for-Increased-Maritime-Security" target="_blank">GitHub</a></footer>
<div class="toast" id="toast"></div>

<script>
const dropzone   = document.getElementById('dropzone');
const fileInput  = document.getElementById('fileInput');
const fileInfo   = document.getElementById('fileInfo');
const processBtn = document.getElementById('processBtn');
const progress   = document.getElementById('progress');
const barFill    = document.getElementById('barFill');
const progText   = document.getElementById('progressText');
const result     = document.getElementById('result');
const resultVid  = document.getElementById('resultVideo');
const dlLink     = document.getElementById('downloadLink');
const toast      = document.getElementById('toast');
let selectedFile = null;

// Drag & drop
['dragenter','dragover'].forEach(e=>dropzone.addEventListener(e,ev=>{ev.preventDefault();dropzone.classList.add('drag-over')}));
['dragleave','drop'].forEach(e=>dropzone.addEventListener(e,ev=>{ev.preventDefault();dropzone.classList.remove('drag-over')}));
dropzone.addEventListener('drop',ev=>{if(ev.dataTransfer.files.length)pickFile(ev.dataTransfer.files[0])});
fileInput.addEventListener('change',()=>{if(fileInput.files.length)pickFile(fileInput.files[0])});

function pickFile(file){
    selectedFile=file;
    fileInfo.textContent='ðŸ“ '+file.name+' ('+( file.size/1048576).toFixed(1)+' MB)';
    fileInfo.classList.add('show');
    processBtn.disabled=false;
}

// Upload & process
processBtn.addEventListener('click', async ()=>{
    if(!selectedFile) return;
    processBtn.disabled=true;
    progress.classList.add('show');
    result.classList.remove('show');
    barFill.style.width='0%';
    progText.textContent='Uploading & enhancing framesâ€¦ this may take a while.';

    let pct=0;
    const timer=setInterval(()=>{pct=Math.min(pct+Math.random()*3,90);barFill.style.width=pct+'%'},500);

    const fd=new FormData();
    fd.append('video',selectedFile);

    try{
        const res=await fetch('/api/upload',{method:'POST',body:fd});
        clearInterval(timer);
        if(!res.ok){const e=await res.json();throw new Error(e.detail||'Server error')}
        const data=await res.json();
        barFill.style.width='100%';
        progText.textContent=data.message;
        setTimeout(()=>{
            resultVid.src=data.video_url;
            dlLink.href=data.video_url;
            dlLink.download=data.filename;
            result.classList.add('show');
            result.scrollIntoView({behavior:'smooth',block:'start'});
        },400);
    }catch(err){
        clearInterval(timer);
        showToast(err.message);
        progress.classList.remove('show');
    }finally{processBtn.disabled=false}
});

function resetUI(){
    selectedFile=null;fileInput.value='';fileInfo.classList.remove('show');
    processBtn.disabled=true;progress.classList.remove('show');result.classList.remove('show');
    barFill.style.width='0%';window.scrollTo({top:0,behavior:'smooth'});
}
function showToast(msg){
    toast.textContent='âš ï¸ '+msg;toast.classList.add('show');
    setTimeout(()=>toast.classList.remove('show'),4000);
}
</script>
</body>
</html>
